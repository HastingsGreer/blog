<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/tufte.css"> <link rel=stylesheet  href="/css/latex.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="https://apj.hgreer.com/blog"> <link rel=icon  href="/assets/favicon.png"> <script> fetch("https://apj.hgreer.com/referrer?" + document.referrer); </script> <title>Jan102022</title> <div id=layout > <div id=menu > <ul> <li><a href="/">Home</a> <!-- <li><a href="/FeatureMapICON/">Feature Map Inverse Consistency</a> --> <li><a href="/HatTile/">Aperiodic Tiling with Z3</a> <!-- <li><a href="/ICON/">Inverse Consistent Regstration</a> <li><a href="/Mandelbrot/">Mandelbrot Set Adventures</a> --> <li><a href="/JavascriptMandelbrot/">Mandelbrot Set</a> <li><a href="/TrebuchetSimulator/">Trebuchet Simulator</a> <li><a href="/BadMatrixMultiply/">Bad Matrix Multiplication</a> <li><a href="/TwistyPuzzle/">Twisty Puzzles</a> <li><a href="/GameJam/">Game Jam Games</a> <li><a href="/menu3/">Tags</a> </ul> </div> <div id=main > <div class=franklin-content ><h2 id=new_approach_for_weekly_meetings ><a href="#new_approach_for_weekly_meetings" class=header-anchor >New approach for weekly meetings?</a></h2> <p>I thought it would more useful to put my thoughts into text and LaTeX than into powerpoint every week, since it will be easier to keep track of and to put into publications when I write up my research. For update purposes, is this as good as a weekly powerpoint?</p> <h2 id=worked_on_writeup_of_fmapicon_rolling_loss ><a href="#worked_on_writeup_of_fmapicon_rolling_loss" class=header-anchor >Worked on writeup of FMAPICON Rolling Loss</a></h2> <p>Performance has plateaued on the DAVIS task, although I left it training all week. I put some effort into explaining why the rolling loss helps, along with a more general <a href="/FeatureMapICON/#attempt_3_rolling_augmentation">Writeup</a> of the augmentation approach to equivarianceâ€“ if I can wrangle this into a paper, then this writing will be useful.</p> <h2 id=worked_on_implementing_icon_feature_requests ><a href="#worked_on_implementing_icon_feature_requests" class=header-anchor >Worked on implementing ICON feature requests</a></h2> <img src="/assets/ICON_test/warpedA.png" alt=""> <p><a href="/ICON_test">Figures</a></p> <p>I am struggling with wrangling itk&#39;s displacementFieldTransform object to do what I want: the interface between numpy arrays and itk images with vector valued pixels is the pain point: it is loose and performs few checks, and so mistakes cause garbage transforms instead of run-time or compile time errors. Currently, as shown above, I am getting garbage transforms. I am confident that I can power through these errors shortly, but this does make me hesitate to throw the other grad students at this as &quot;the interface to end all interfaces.&quot; I should email matt about the problems I am having.</p> <p>UPDATE: I was casting to long instead of double. The larger issue of poor error checking in this corner of ITK stands, as that sort of type pun should be a runtime error. I may make a pull request. The transforms are still garbage, of course, but believe me they were worse.</p> <p>UPDATE 2: The stride situation was a disaster. I&#39;ve fixed it with a <a href="https://github.com/HastingsGreer/InverseConsistency/blob/0a1f78f29766e0eaab2a6fa4b7eaf9f0868d986d/src/icon_registration/itk_wrapper.py#L104">hack</a> but definitely need to make a pull request upstream for the way pybuffer interacts with vector valued images.</p> <p>Up to this point I have gotten displacementFieldTransform working for spacing-1 images, but there is some work to do to make sure it can accomodate all spacings.</p> <p>We have decided on this approach for accomodating unusual spacings:</p> <ul> <li><p>resize the two images directly to the neural network input size </p> <li><p>process them using the pretrained neural network</p> <li><p>postprocess the resulting deformation to be valid for the original spacings</p> </ul> <p>Once I have a correctly initialized itk.displacementFieldTransform then I can use it to <a href="https://github.com/HastingsGreer/InverseConsistency/blob/bf488289726e69c70a77ac172f1919e83dc250c9/test/test_itk_integration.py#L34">warp an image</a> using a very standard itk idiom.</p> <p>This then makes <a href="https://itk.org/ITKExamples/src/Filtering/ImageCompare/CombineTwoImagesWithCheckerBoardPattern/Documentation.html">checkerboard visualization</a> and Dice calculation easy.</p> <p><a href="https://github.com/HastingsGreer/InverseConsistency/blob/itkIntegration/TODO.md">ICON Todo</a></p> <p>The remaining big items on the ToDo list center around training with label losses, atlas losses, and training strategy. We can discuss what do to during today&#39;s meeting&#33; I have read zhipeng&#39;s paper, he gets excellent registration results</p> <hr /> <p><a href="/Reports">Back to weekly reports</a></p> <a href=/Reports/>Back to Reports</a> <div class=page-foot > <div> <a href=https://subdavis.com>subdavis.com </a> <a href=http://forrestli.con>forrestli.com</a> <div class=copyright > &copy; Hastings Greer. Last modified: August 23, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div>