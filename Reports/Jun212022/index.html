<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/tufte.css"> <link rel=stylesheet  href="/css/latex.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=icon  href="/assets/favicon.png"> <title>Lung results&#33;</title> <div id=layout > <div id=menu > <ul> <li><a href="/">Home</a> <!-- <li><a href="/FeatureMapICON/">Feature Map Inverse Consistency</a> --> <li><a href="/ICON/">Inverse Consistent Regstration</a> <li><a href="/Mandelbrot/">Mandelbrot Set Adventures</a> <li><a href="/BadMatrixMultiply/">Bad Matrix Multiplication</a> <li><a href="/GameJam/">Game Jam Games</a> <li><a href="/menu3/">Tags</a> </ul> </div> <div id=main > <div class=franklin-content ><h2 id=lung_results ><a href="#lung_results" class=header-anchor >Lung results&#33;</a></h2> <p>In all cases: </p> <p>LNCC loss with sigma&#61;5 pixels</p> <p>Augmentation: random permutation &#43; flipping of axis &#43; 10&#37; affine warping.</p> <p>Augmentation implemented here: <a href="https://github.com/HastingsGreer/ICON_lung/blob/d1576a0131c4d7783987ee6292ed13f07113a748/triple_deformable_lung.py##L68">github</a></p> <p>Image preprocessing: clip intensity to &#91;-1000, 0&#93;, scale to &#91;-1, 0&#93;, shift to &#91;0, 1&#93;, mask out lung.</p> <p>Preprocessing available here: <a href="https://github.com/uncbiag/ICON/blob/545fb1cac7429b35c2447a351a44f5d870917834/src/icon_registration/pretrained_models/lung_ct.py##L33">github</a></p> <p>lambda&#61;1</p> <p>On to the cases:</p> <p>High resolution, no finetuning:</p> <pre><code class="julia hljs">mTRE: <span class=hljs-number >2.3006992213541535</span>, mTRE_X: <span class=hljs-number >0.8731911562027538</span>, mTRE_Y: <span class=hljs-number >1.1455374789234933</span>, mTRE_Z: <span class=hljs-number >1.3988634236498467</span>, DICE: <span class=hljs-number >0.9839835991734549</span>
mTRE: <span class=hljs-number >1.7353536802929188</span>, mTRE_X: <span class=hljs-number >0.6434888778122482</span>, mTRE_Y: <span class=hljs-number >0.8173537622369533</span>, mTRE_Z: <span class=hljs-number >1.0992206030662603</span>, DICE: <span class=hljs-number >0.9875824779902229</span>
<span class=hljs-number >0.9839835991734549</span></code></pre> <p>High resolution, finetuning:</p> <pre><code class="julia hljs">mTRE: <span class=hljs-number >1.5035167981939945</span>, mTRE_X: <span class=hljs-number >0.5783369599852262</span>, mTRE_Y: <span class=hljs-number >0.7254410319306086</span>, mTRE_Z: <span class=hljs-number >0.9301830532375389</span>, DICE: <span class=hljs-number >0.9870256044148528</span>
mTRE: <span class=hljs-number >1.2175174987112052</span>, mTRE_X: <span class=hljs-number >0.4692889806645579</span>, mTRE_Y: <span class=hljs-number >0.5572003989919224</span>, mTRE_Z: <span class=hljs-number >0.7828604378504245</span>, DICE: <span class=hljs-number >0.9895374508621282</span>
<span class=hljs-number >0.9870256044148528</span></code></pre> <p>Low resolution, no finetuning:</p> <pre><code class="julia hljs">mTRE: <span class=hljs-number >2.6811465187351606</span>, mTRE_X: <span class=hljs-number >0.992520793545659</span>, mTRE_Y: <span class=hljs-number >1.389975279426745</span>, mTRE_Z: <span class=hljs-number >1.5807646716690722</span>, DICE: <span class=hljs-number >0.9704927550796143</span>
mTRE: <span class=hljs-number >2.0511508312603874</span>, mTRE_X: <span class=hljs-number >0.7512121502866995</span>, mTRE_Y: <span class=hljs-number >1.0436619656409658</span>, mTRE_Z: <span class=hljs-number >1.2434038192848738</span>, DICE: <span class=hljs-number >0.9784813035820681</span>
<span class=hljs-number >0.9859310202970379</span></code></pre> <p>Low resolution, finetuning:</p> <pre><code class="julia hljs">mTRE: <span class=hljs-number >1.9011778275171511</span>, mTRE_X: <span class=hljs-number >0.7254579471524127</span>, mTRE_Y: <span class=hljs-number >0.9877803858492393</span>, mTRE_Z: <span class=hljs-number >1.1078842197419392</span>, DICE: <span class=hljs-number >0.974102213784451</span>
mTRE: <span class=hljs-number >1.4957662203853648</span>, mTRE_X: <span class=hljs-number >0.5709490608602367</span>, mTRE_Y: <span class=hljs-number >0.7459466674727133</span>, mTRE_Z: <span class=hljs-number >0.9081815544914023</span>, DICE: <span class=hljs-number >0.9802951342755577</span>
<span class=hljs-number >0.9900536332107993</span></code></pre> <h1 id=todo ><a href="#todo" class=header-anchor >TODO</a></h1> <h2 id=cleanup_todo ><a href="#cleanup_todo" class=header-anchor >Cleanup todo</a></h2> <p>✓ footsteps needs to log uncommitted file if that&#39;s what&#39;s being run</p> <p>✓ merge code in &quot;/media/data/hastings/InverseConsistency/&quot; into master</p> <p>✓ get OAI pull request merged</p> <p>compress OAI models by dropping identitymaps</p> <p>add identitymap stripping code to ICON</p> <p>ICON 1.0 release</p> <p>merge biag .vimrc</p> <p>put augmentation into train.py</p> <h2 id=ambitious_todo ><a href="#ambitious_todo" class=header-anchor >Ambitious todo</a></h2> <p>genius idea: registration that improves previous result: train by randomy resetting prev result</p> <p>try segmenting latest kaggle challenge</p> <p>try registering latest kaggle challenge</p> <p>99&#37;ICON: ICON but the worst 1&#37; of inverse consistencies aren&#39;t penalized</p> <p>mixture of gaussians ICON: interpret ICON as &quot;registration outputs a gaussian at each pixel, ICON loss is log odds of exact inverse consistency. in that framework, rewrite to output a mixture of gaussians instead of a gaussian: perhaps can accurately model tearing?</p> <p>need a synthetic dataset for tearing.</p> <p>one approach to mitigate this is to create a very diverse zoo of intensity transfer functions for data augmentation, and hope that this forces the network to learn to register a larger complete set of transfer functions including MR -&gt; CT even though that&#39;s not a strict 1-1 function <a href="https://fairlydeep.slack.com/files/UKV1W0FDX/F03L71Z79PB/synthmorph_learning_contrast-invariant_registration_without_acquired_images.pdf">Adrien&#39;s paper</a></p> <h2 id=marc_request_todo ><a href="#marc_request_todo" class=header-anchor >Marc request todo</a></h2> <p>✓ train oai knees with LNCC &#43; augmentation</p> <ul> <li><p>currently training with just LNCC for taste. Will try next with LNCC &#43; augmentation</p> </ul> <p>train lung with lin loss &#43; augmnentation</p> <p>✓ evaluate latest highres model</p> <p>✓ put all results into the overleaf</p> <p>make formal list of experiments for paper – journal article?</p> <p>put OAI preprocessing into pretrained models</p> <p>Create a set of images where the shapes are bright and the background dark. Create another set where it is the other way around. Train a network that gets as inputs either a random image pair from one or from the other. Will this network entirely fail if it is presented with a pair where one image is from one set and the other one from the other?</p> <p>non neural finetune</p> <h2 id=itk_deficiencies_todo ><a href="#itk_deficiencies_todo" class=header-anchor >ITK deficiencies todo</a></h2> <p>verify whether itk can be installed on an old version yet?</p> <p>get itk to not segfault when asked to save a composite transform without &#91;&#93;ifying it</p> <p>get itkDisplacementFieldJacobianFilter wrapped for doubles</p> <div class=page-foot > <div> <a href=https://subdavis.com>subdavis.com </a> <a href=http://forrestli.con>forrestli.com</a> <div class=copyright > &copy; Hastings Greer. Last modified: June 16, 2022. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div>