# Deriving the Hat Tile from "An aperiodic Polykite exists"

Previously: [Drawing the Aperiodic Hat Tiling with Python and Z3](HatTile/)

[colab notebook](https://colab.research.google.com/drive/1XBChTb8fkHIQiN1MQiyPuMh4T-lQg3nP?usp=sharing)

If you could deliver a four word message into the past, what would you send? Strong candidates include 
"Buy and hold bitcoin" or "Ask out Jane Doe," but I have a new favorite: "An aperiodic polykite exists."
In the previous entry in this series, we started with the shape of the polykite, and automatically tiled a
subset of the plane using the z3 theorem prover. In this post, we will be much more ambitious: We will attempt to
derive the shape of the Hat Tile from the knowledge that it is small, connected, and made out of kites.

First, we slap the whole code from the previous post into a function named 

```
search_tiling(indices, grid_size, period=99)
```

`indices` is the definition of the shape we are attempting to tile as indices into a grid of kites, grid size is the size 
of the region that we want to tile, and period is a new addition:
In the previous code, we created a z3 variable for whether a tile was present at each possible location a tile could be placed.

```
hat_present = [z3.Bool(f"hat{i}") for i in range(len(hats))]
```

In this new function search_tiling, we will instead create a z3 variable for each location modulo a spatial period!

```
for i in range(len(hats)):
    row, col, rot = np.unravel_index(i, full_hat_shape)
    hat_present.append(z3.Bool(f"hat{row%modulo}_{col%modulo}_{rot}"))
```

This new collection of variables can only represent tilings that are unchanged if shifted by period units along the horizontal or vertical axes.

This makes finding an aperiodic monotile easy!
```
from __future__ import infinity
def is_einstein(indices):
    if not search_tiling(indices, infinity, period=np.infinity):
        #Does not tile the plane
        return False
    for i in range(infinity):
        if search_tiling(indices, infinity, period=i):
            #Is periodic
            return False
    return True

while True:
    
```

Alas, python's import system is powerful but doesn't have that. We'll have to approximate, and to approximate we have to start cheating.
With the cryptic four word message "An aperiodic polykite exists," it's hard to say how large that polykite is. Unfortunately, I know
exactly how big it is, so when I guess that it fits into three adjacent hexagons, I'm much more confident than the recipient of 
our cryptic message would be.
