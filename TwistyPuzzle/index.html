<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/tufte.css"> <link rel=stylesheet  href="/css/latex.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="https://apj.hgreer.com/blog"> <link rel=icon  href="/assets/favicon.png"> <script> fetch("https://apj.hgreer.com/referrer?" + document.referrer); </script> <title></title> <div id=layout > <div id=menu > <ul> <li><a href="/">Home</a> <!-- <li><a href="/FeatureMapICON/">Feature Map Inverse Consistency</a> --> <li><a href="/HatTile/">Aperiodic Tiling with Z3</a> <!-- <li><a href="/ICON/">Inverse Consistent Regstration</a> <li><a href="/Mandelbrot/">Mandelbrot Set Adventures</a> --> <li><a href="/JavascriptMandelbrot/">Mandelbrot Set</a> <li><a href="/TrebuchetSimulator/">Trebuchet Simulator</a> <li><a href="/BadMatrixMultiply/">Bad Matrix Multiplication</a> <li><a href="/TwistyPuzzle/">Twisty Puzzles</a> <li><a href="/GameJam/">Game Jam Games</a> <li><a href="/menu3/">Tags</a> </ul> </div> <div id=main > <div class=franklin-content ><img src="/assets/TwistyPuzzle/code/header.png" alt=""> <p>The in browser, playable rubiks cubes, including a pyraminx and a face turing octahedron, are currently hosted <a href="http://cubes.hgreer.com">here</a>. Hopefully this post will eventually get to explaining how they work</p> <p>Rubiks cubes are fascinating, and I&#39;ve been working on writing a post about solving them for a while. At first, I thought that the post would be about solving them, and the draft of that post is at &#40;link&#41; but I quickly realized that the post about solving them needed playable, embedded widgets where the reader could try the techniques in question. </p> <pre><code class="plaintext hljs">PyObject &lt;module &#x27;scipy&#x27; from &#x27;/opt/hostedtoolcache/Python/3.10.18/x64/lib/python3.10/site-packages/scipy/__init__.py&#x27;&gt;</code></pre>
<p><a href=SolveARubiksCubeWithoutMemorization.md >The unfinishable post in question</a></p>
<p>Thus, this post started, a prequel of sorts, about how to embed a twisty cube widget in a website. It becomes a bit of a journey.</p>
<p>I started off implementing a copy of Simon Tatham&#39;s &quot;Twiddle&quot;, which is a simplified puzzle with rubiks like motion. Instead of stickers on cublets, it just has 16 tiles in a square, with the ability to turn 3x3 sub-sets of the puzzle by 90 degrees. I elected to represent the state of the puzzle and the moves as 16 x 16 permutation matrices. Then, I could apply a move  by simply multiplying it with the state. Render the puzzle by multiplying the state with a &quot;piece location&quot; matrix. </p>
<pre><code class="julia hljs"><span class=hljs-keyword >import</span> numpy as np
<span class=hljs-keyword >import</span> matplotlib.pyplot as plt
<span class=hljs-keyword >import</span> sys
state = np.eye(<span class=hljs-number >16</span>)
display_matrix = []
<span class=hljs-keyword >for</span> i <span class=hljs-keyword >in</span> range(<span class=hljs-number >4</span>):
  <span class=hljs-keyword >for</span> j <span class=hljs-keyword >in</span> range(<span class=hljs-number >4</span>):
    display_matrix.append([j / <span class=hljs-number >4</span> + <span class=hljs-number >1</span>/<span class=hljs-number >8</span>, <span class=hljs-number >7</span>/<span class=hljs-number >8</span> - i / <span class=hljs-number >4</span>])
display_matrix = np.array(display_matrix)
def show(state):
  [plt.text(x, y, str(i), ha=&#x27;center&#x27;, va=&#x27;center&#x27;, fontsize=<span class=hljs-number >16</span>)
   <span class=hljs-keyword >for</span> i, (x, y) <span class=hljs-keyword >in</span> enumerate(state @ display_matrix)]
show(state)</code></pre>
<img src="/assets/TwistyPuzzle/code/output/board.png" alt="">
<p>Now, for a first pass, we just hand write the permutation for a single move</p>
<pre><code class="julia hljs">A = (np.
array([[<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>, <span class=hljs-number >0.</span>],
       [<span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >0.</span>, <span class=hljs-number >1.</span>]]))
show(A @ state)</code></pre>
<img src="/assets/TwistyPuzzle/code/output/boardTwisted.png" alt="">
<p>This successfully twisted the top left square&#33; </p>
<p>Now, this is where the magic starts, and the justification arrives for representing moves via matrices. How are  we going to animate this move? Easy&#33; if we want the move to take 2 frames, we just take the square root of A&#33; </p>
<pre><code class="julia hljs">from scipy.linalg <span class=hljs-keyword >import</span> logm, expm
show(expm(logm(A) / <span class=hljs-number >2</span>) @ state)</code></pre>
<img src="/assets/TwistyPuzzle/code/output/boardroot.png" alt="">
<p>This works for any fraction of a turn we want, allowing easy smooth animation of any permutation.</p>


<div class=page-foot >
  <div>
    <a href=https://subdavis.com>subdavis.com </a> 
    <a href=http://forrestli.con>forrestli.com</a>
  <div class=copyright >
    &copy; Hastings Greer. Last modified: August 06, 2025. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>.
  </div>
</div>
</div>
        </div> 
    </div>